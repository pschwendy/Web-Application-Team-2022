<!DOCTYPE html>
<html>
    <head>
        <!-- Required meta tags -->
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Reserve</title>
        <!-- Bootstrap CSS -->
        <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
        <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
        
        <!--Include CSS Stylesheets-->
        <link rel="stylesheet" href="/public/theme.css">
        <link rel="stylesheet" href="/public/Login.css">
        <link rel="stylesheet" href="/public/Nav.css">
        <link rel="stylesheet" href="/public/HeroImage.css">
        <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>

        <!-- Google Sign In -->
        <script src="https://apis.google.com/js/platform.js" async defer></script>
        <script src="https://apis.google.com/js/api:client.js"></script>
        <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet" type="text/css">
        <script src="https://apis.google.com/js/api:client.js"></script>
        <meta name="google-signin-client_id" content="409957581376-mj4a4cpr59lng5tojabia8ust2fblo47.apps.googleusercontent.com">
    </head>
    <body>
        <script type="module" src="/public/components/NavBarButBetter.js"></script>
        <script type="module" src="/public/components/AccountButton.js"></script>
        <nav-bar-but-better></nav-bar-but-better>
        <script>
            function removeG() {
                console.log("CALLED: " + gapi.auth2.getAuthInstance());
                var auth2 = gapi.auth2.getAuthInstance();
                auth2.disconnect();
                console.log("DISCONNECTED");
                fetch('/logout').then(result => {
                    if(result) {
                        location.reload();
                    } else {
                        alert("There was a problem removing cookies");
                    }
                })
            }
        </script>
        <div id="page">
            <div id="side-bar" class="container border bg-light" style="width: 30%; padding: 15px;">
                <form action="/login-normal" method="POST" style="width: 90%; margin: auto;">
                    
                    <div class="mb-3">
                        <h1>Log In</h1>
                    </div>
                    <div class="mb-3">
                      <label for="username">Username or Email:</label>
                      <br>
                      <input required type="text" name="username" id="username" style="width: 100%;"/>     
                    </div>
                    <div class="mb-3">
                        <label for="password">Password:</label>
                        <br>
                        <input type="password" required name="password" id="password" style="width: 100%;"/>     
                    </div>  
                    <div class="text-center" style="position:relative; width: 100%;">
                        <button style="margin-top: 10px; width: 100%; margin-bottom: 10px;"type="submit" class="btn btn-primary">Sign In</button>
                        <div style="display: inline-flex; position: relative; text-align: center; width: 100%;">
                          <div style="left: 0; margin-left: 5%; width: 40%; position: absolute; top: 50%; border: 1px solid black;"></div>
                          <div style="position: absolute; top: 50%; left:50%; transform: translate(-50%, -50%);">Or</div>
                          <div style="margin-right: 5%; right:0; width: 40%; position: absolute; top: 50%; border: 1px solid black;"></div>
                        </div>
                        <button id="customBtn" data-onsuccess="onSignIn" onclick="return false;" style="margin-top: 20px; width: 100%;" class="customGPlusSignIn btn btn-success">
                            <img class="google-logo" src="https://developers.google.com/identity/sign-in/g-normal.png">
                            <span class="my-icon"></span>
                            <div class="background-text">Sign In with Google</div>
                        </button>
                        
                        <!--<h2>OR</h2>
                        <div class="g-signin2" style="width: 100% !important;" data-onsuccess="onSignIn"></div>-->
                        <script>
                            var googleUser = {};
                            var startApp = function() {
                                gapi.load('auth2', function() {
                                    // Retrieve the singleton for the GoogleAuth library and set up the client.
                                    auth2 = gapi.auth2.init({
                                        client_id: '409957581376-mj4a4cpr59lng5tojabia8ust2fblo47.apps.googleusercontent.com',
                                        cookiepolicy: 'single_host_origin',
                                        // Request scopes in addition to 'profile' and 'email'
                                        //scope: 'additional_scope'
                                    });
                                    attachSignin(document.getElementById('customBtn'));
                                });
                            };

                            function attachSignin(element) {
                                auth2.attachClickHandler(element, {}, function(googleUser) {
                                    onSignIn(googleUser);
                                });
                                return false;
                            }
                            
                            function onFailure(error) {
                                console.log(error);
                            }   

                            function onSignIn(googleUser) {
                                fetch('/gsignin/' + googleUser.getAuthResponse().id_token)
                                .then(() => {
                                    location.replace("/");
                                });
                            }
                            startApp();
                        </script>
                    </div>
                    <div class="mb-3 d-grid gap-2 col-6 mx-auto" style="text-align: center;">
                        
                    </div>
                    <div>Don't have an account? <a href="/signup">Sign Up</a></div>
                </form>
            </div>
        </div>
        <script type="module" src="/public/components/HeroImage.js"></script>
        <!--<hero-image img="/public/images/derp.jpg"></hero-image>-->
        <img src="/public/images/derp.jpg" class="hero" alt="Hero">
    </body>
</html>